function Ion(){this.preloaderSelector,this.preloaderStartInterval=700}function showSystemMessages(){$("#SystemMessages>div").not(".showed").addClass("showed").animate({marginBottom:1e3,opasity:0},0).show().animate({marginBottom:5,opasity:1},700).delay(3e3).fadeOut(300,function(){this.remove()})}Ion.prototype={escapeRegExp:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},replaceAll:function(e,t,a){return a.replace(new RegExp(this.escapeRegExp(e),"g"),t)},setPreloader:function(e){this.preloaderSelector=e},preloaderShow:function(){var e=this.preloaderSelector;e||(this.preloaderSelector=e="#Preloader");var t=this.preloaderStartInterval;$(e).attr("complite","false"),setTimeout(function(){"false"===$(e).attr("complite")&&($(e).fadeIn(300),$("body").css("cursor","wait"))},t)},preloaderHide:function(){$(this.preloaderSelector).attr("complite","true"),$(this.preloaderSelector).hide(),$("body").css("cursor","default")},parseAttr:function(e,t){return RegExp(e+"=(.+?);","ig").test(t)?RegExp(e+"=(.+?);","ig").exec(t)[1]:!1},errorAlert:function(e){$(body).append("<erroralert><errorclose>x</errorclose>"+e+"<erroralert>")},dataParse:function(e){for(var t=$(e).length,a=new FormData,r=0;t>r;r++){var o=$(e).eq(r),n=$(o).attr("name");if("file"==o.attr("type")){var s=o[0].files;$.each(s,function(e,t){a.append(e,t)})}else""!==o.val()?a.append(n,o.val()):void 0===o.attr("value")?a.append(n,o.text()):a.append(n,o.attr("value"))}return a},cmd:function(ac){var acArr=ac.split("->"),acNext=!1;acArr.length>1&&(ac=acArr[0],acArr.splice(0,1),acNext=acArr.join("->"));var data=this.parseAttr("data",ac),ajax=this.parseAttr("ajax",ac),htmldata=this.parseAttr("html",ac),appendto=this.parseAttr("append",ac),prependto=this.parseAttr("prepend",ac),val=this.parseAttr("val",ac),run=this.parseAttr("run",ac),modal=this.parseAttr("modal",ac),debug=this.parseAttr("debug",ac),type=this.parseAttr("type",ac),clean=this.parseAttr("clean",ac),reload=this.parseAttr("reload",ac),get=this.parseAttr("get",ac);type||(type="post");var send=!1;if(val&&(val=this.replaceAll("'",'"',val),val=JSON.parse("{"+val+"}")),data&&(send=this.dataParse(data)),val&&data&&(send=$.extend(send,val)),val&&!data&&(send=val),ajax){get&&(ajax+=location.search);var $this=this;$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:type,url:ajax,cache:!1,beforeSend:function(){$this.preloaderShow()},data:send,processData:!1,contentType:!1,error:function(e){console.log(e),$("html").html(e.responseText)},success:function(e){$this.preloaderHide(),htmldata&&$(htmldata).html(e),appendto&&$(appendto).append(e),prependto&&$(prependto).prepend(e),modal&&($(modal+" .modal-content").html(e),$(modal).modal("show")),debug&&console.log(e)}})}else if(htmldata){for(var html in send)break;$(htmldata).html(send[html])}run&&eval(run),clean&&$(clean).val("").text(""),reload&&setTimeout(function(){location.reload()},1e3*reload),"hide"===modal&&$(".modal").modal("hide"),acNext&&this.cmd(acNext)}};var ion=new Ion;$(document).on("click","[ion]",function(){ion.cmd($(this).attr("ion"))}),$(window).load(function(){showSystemMessages()}),$("#SystemMessages").bind("DOMSubtreeModified",function(){showSystemMessages();var e=$("ion").text();e&&ion.cmd(e)});
